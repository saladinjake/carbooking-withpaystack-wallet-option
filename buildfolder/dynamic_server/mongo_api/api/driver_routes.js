"use strict";

var cov_1h57fsrwtx = function () {
  var path = "C:\\Users\\Obiajulu\\Desktop\\commute\\commute-dev-Proj-repo\\server\\dynamic_server\\mongo_api\\api\\driver_routes.js";
  var hash = "8b19fdadb6a83dacd9966cfc9b1f043082de6658";
  var global = new Function("return this")();
  var gcv = "__coverage__";
  var coverageData = {
    path: "C:\\Users\\Obiajulu\\Desktop\\commute\\commute-dev-Proj-repo\\server\\dynamic_server\\mongo_api\\api\\driver_routes.js",
    statementMap: {
      "0": {
        start: {
          line: 21,
          column: 20
        },
        end: {
          line: 21,
          column: 42
        }
      },
      "1": {
        start: {
          line: 22,
          column: 19
        },
        end: {
          line: 22,
          column: 40
        }
      },
      "2": {
        start: {
          line: 28,
          column: 17
        },
        end: {
          line: 34,
          column: 5
        }
      },
      "3": {
        start: {
          line: 45,
          column: 4
        },
        end: {
          line: 45,
          column: 25
        }
      },
      "4": {
        start: {
          line: 57,
          column: 4
        },
        end: {
          line: 62,
          column: 6
        }
      },
      "5": {
        start: {
          line: 63,
          column: 4
        },
        end: {
          line: 67,
          column: 7
        }
      },
      "6": {
        start: {
          line: 68,
          column: 4
        },
        end: {
          line: 68,
          column: 87
        }
      },
      "7": {
        start: {
          line: 69,
          column: 4
        },
        end: {
          line: 69,
          column: 89
        }
      },
      "8": {
        start: {
          line: 70,
          column: 4
        },
        end: {
          line: 70,
          column: 82
        }
      },
      "9": {
        start: {
          line: 72,
          column: 4
        },
        end: {
          line: 72,
          column: 96
        }
      },
      "10": {
        start: {
          line: 73,
          column: 4
        },
        end: {
          line: 73,
          column: 92
        }
      },
      "11": {
        start: {
          line: 75,
          column: 4
        },
        end: {
          line: 78,
          column: 7
        }
      },
      "12": {
        start: {
          line: 76,
          column: 6
        },
        end: {
          line: 76,
          column: 19
        }
      },
      "13": {
        start: {
          line: 77,
          column: 6
        },
        end: {
          line: 77,
          column: 24
        }
      },
      "14": {
        start: {
          line: 82,
          column: 4
        },
        end: {
          line: 85,
          column: 6
        }
      },
      "15": {
        start: {
          line: 87,
          column: 4
        },
        end: {
          line: 91,
          column: 6
        }
      },
      "16": {
        start: {
          line: 94,
          column: 4
        },
        end: {
          line: 97,
          column: 6
        }
      },
      "17": {
        start: {
          line: 99,
          column: 4
        },
        end: {
          line: 102,
          column: 5
        }
      },
      "18": {
        start: {
          line: 109,
          column: 4
        },
        end: {
          line: 114,
          column: 6
        }
      },
      "19": {
        start: {
          line: 116,
          column: 4
        },
        end: {
          line: 121,
          column: 6
        }
      },
      "20": {
        start: {
          line: 124,
          column: 4
        },
        end: {
          line: 128,
          column: 6
        }
      },
      "21": {
        start: {
          line: 131,
          column: 4
        },
        end: {
          line: 135,
          column: 6
        }
      },
      "22": {
        start: {
          line: 268,
          column: 4
        },
        end: {
          line: 268,
          column: 23
        }
      }
    },
    fnMap: {
      "0": {
        name: "(anonymous_0)",
        decl: {
          start: {
            line: 43,
            column: 2
          },
          end: {
            line: 43,
            column: 3
          }
        },
        loc: {
          start: {
            line: 43,
            column: 22
          },
          end: {
            line: 46,
            column: 3
          }
        },
        line: 43
      },
      "1": {
        name: "(anonymous_1)",
        decl: {
          start: {
            line: 48,
            column: 2
          },
          end: {
            line: 48,
            column: 3
          }
        },
        loc: {
          start: {
            line: 48,
            column: 17
          },
          end: {
            line: 269,
            column: 3
          }
        },
        line: 48
      },
      "2": {
        name: "(anonymous_2)",
        decl: {
          start: {
            line: 75,
            column: 39
          },
          end: {
            line: 75,
            column: 40
          }
        },
        loc: {
          start: {
            line: 75,
            column: 57
          },
          end: {
            line: 78,
            column: 5
          }
        },
        line: 75
      }
    },
    branchMap: {},
    s: {
      "0": 0,
      "1": 0,
      "2": 0,
      "3": 0,
      "4": 0,
      "5": 0,
      "6": 0,
      "7": 0,
      "8": 0,
      "9": 0,
      "10": 0,
      "11": 0,
      "12": 0,
      "13": 0,
      "14": 0,
      "15": 0,
      "16": 0,
      "17": 0,
      "18": 0,
      "19": 0,
      "20": 0,
      "21": 0,
      "22": 0
    },
    f: {
      "0": 0,
      "1": 0,
      "2": 0
    },
    b: {},
    _coverageSchema: "43e27e138ebf9cfc5966b082cf9a028302ed4184",
    hash: "8b19fdadb6a83dacd9966cfc9b1f043082de6658"
  };
  var coverage = global[gcv] || (global[gcv] = {});

  if (coverage[path] && coverage[path].hash === hash) {
    return coverage[path];
  }

  return coverage[path] = coverageData;
}();

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports["default"] = void 0;

var _classCallCheck2 = _interopRequireDefault(require("@babel/runtime/helpers/classCallCheck"));

var _createClass2 = _interopRequireDefault(require("@babel/runtime/helpers/createClass"));

var _driver_controller = _interopRequireDefault(require("../controllers/driver_controller"));

var _driver_sanitizer = _interopRequireDefault(require("../middlewares/driver_sanitizer"));

var _Driver = _interopRequireDefault(require("../models/Driver.model"));

var _token_validator = _interopRequireDefault(require("../middlewares/token_validator"));

var _post_sanitizer = _interopRequireDefault(require("../middlewares/post_sanitizer"));

var _jsonwebtoken = _interopRequireDefault(require("jsonwebtoken"));

var _token_generator = require("../helpers/token_generator");

var _App = require("../App");

var _mongo_config = _interopRequireDefault(require("../config/mongo_config"));

var _request = _interopRequireDefault(require("request"));

var _cors = _interopRequireDefault(require("cors"));

// import BridgeRoutes from './routes';
var SIGNUP_LINK = (cov_1h57fsrwtx.s[0]++, '/auth/drivers-signup');
var LOGIN_LINK = (cov_1h57fsrwtx.s[1]++, '/auth/drivers-login');
var corsOption = (cov_1h57fsrwtx.s[2]++, {
  origin: true,
  methods: 'GET,HEAD,PUT,PATCH,POST,DELETE',
  credentials: true,
  exposedHeaders: ['x-auth-token'],
  'Access-Control-Allow-Origin': '*'
}); //for e wallet transactions
//const validate = require('express-validation');

var DriversRoutes =
/*#__PURE__*/
function () {
  function DriversRoutes(router) {
    (0, _classCallCheck2["default"])(this, DriversRoutes);
    cov_1h57fsrwtx.f[0]++;
    cov_1h57fsrwtx.s[3]++;
    // super(router);
    this.router = router;
  }

  (0, _createClass2["default"])(DriversRoutes, [{
    key: "attachRoutes",
    value: function attachRoutes() {
      cov_1h57fsrwtx.f[1]++;
      cov_1h57fsrwtx.s[4]++;

      /*
      * Respond to GET requests to /account.
      * Upon request, render the 'account.html' web page in views/ directory.
      */
      // simplelogins
      this.router.post('/auth/drivers-signup', _driver_sanitizer["default"].validateSignUp, _driver_sanitizer["default"].checkIfDriverExists, _driver_controller["default"].signup);
      cov_1h57fsrwtx.s[5]++;
      this.router.post('/auth/drivers-login', _driver_sanitizer["default"].validateLogin, _driver_sanitizer["default"].checkIfDriverIsBanned, _driver_controller["default"].login);
      cov_1h57fsrwtx.s[6]++;
      this.router.post('/auth/drivers-forgot_password', _driver_controller["default"].passwordForgot);
      cov_1h57fsrwtx.s[7]++;
      this.router.get('/auth/drivers-confirmation/:id', _driver_controller["default"].confirmationPost);
      cov_1h57fsrwtx.s[8]++;
      this.router.get('/auth/drivers-resend/:id', _driver_controller["default"].resendTokenPost);
      cov_1h57fsrwtx.s[9]++;
      this.router.get('/auth/drivers-resetMyPassword/:id', _driver_controller["default"].confirmResetPassword); //show form

      cov_1h57fsrwtx.s[10]++;
      this.router.post('/auth/drivers-resetpassword', _driver_controller["default"].changePasswordTrigger);
      cov_1h57fsrwtx.s[11]++;
      this.router.get('/drivers-logout', function (req, res) {
        cov_1h57fsrwtx.f[2]++;
        cov_1h57fsrwtx.s[12]++;
        req.logout();
        cov_1h57fsrwtx.s[13]++;
        res.redirect('/');
      });
      cov_1h57fsrwtx.s[14]++;
      this.router.get('/drivers-profile/update/:id', _token_validator["default"].userAuthentication, _driver_controller["default"].showProfile);
      cov_1h57fsrwtx.s[15]++;
      this.router.post('/drivers-profile/update/:id', _token_validator["default"].userAuthentication, _driver_sanitizer["default"].validateSignUp, _driver_controller["default"].updateProfile);
      cov_1h57fsrwtx.s[16]++;
      this.router.get('/drivers-assigned-user-trips/:id', _token_validator["default"].userAuthentication, _driver_controller["default"].getDriversAssignedTrips);
      cov_1h57fsrwtx.s[17]++;
      this.router.get('/drivers-assigned-cars/:id', _token_validator["default"].userAuthentication, _driver_controller["default"].getAssignedDriverToCars);
      cov_1h57fsrwtx.s[18]++;
      this.router.post('/drivers-sos', _token_validator["default"].userAuthentication, // SubmitEventValidator.validateSubmit,
      _driver_controller["default"].createRedFlag);
      cov_1h57fsrwtx.s[19]++;
      this.router.get('/drivers-sos/:id/users', _token_validator["default"].userAuthentication, // SubmitEventValidator.validateSubmit,
      _driver_controller["default"].usersRedflags);
      cov_1h57fsrwtx.s[20]++;
      this.router.post('/drivers-notifications', _token_validator["default"].userAuthentication, _driver_controller["default"].sendNotifications);
      cov_1h57fsrwtx.s[21]++;
      this.router.get('/drivers-notifications/:id', _token_validator["default"].userAuthentication, _driver_controller["default"].getNotifications); //  this.router.post('/drivers-notification',
      //   TokenVerification.userAuthentication, 
      //    //DriverSanitizer.checkIfUserDoesntExists,
      //   DriverController.makeNotification
      //   );
      //  this.router.get('/drivers-notification/:id',
      //   TokenVerification.userAuthentication, 
      //   DriverController.getUserNotification
      //   );
      //  //drivers
      //  this.router.get('/confirm-booking-request',
      //   //TokenVerification.userAuthentication, 
      //   DriverController.driverConfirmBooking
      // );
      // //update driver socket id
      // this.router.put("/driverLocationSocket/:id", function(req, res, next){
      //   var io = req.app.io;
      //   if(!req.body){
      //     res.status(400);
      //     res.json({
      //       "error":"Bad Data"
      //     });
      //   } else {
      //     console.log(req.params.id)
      //     DriverModel.updateOne({id:req.params.id},
      //       {$set: {socketId:req.body.socketId}}, function(err, updateDetails) {
      //         if(err){
      //           res.send(err);
      //         }else{
      //           console.log(updateDetails )
      //           res.send(updateDetails);
      //         }
      //     });
      //   }
      // });
      // //get nearby driver
      // this.router.get("/driverLocation/:latitude/:longitude", function (req, res, next) {
      //   //DriverModel.ensureIndex({"coordinate": "2dsphere"});
      //   DriverModel.find({
      //     "location": {
      //      "$near": {
      //       "$maxDistance": 1000,
      //       "$geometry": {
      //        "type": "Point",
      //        "coordinates": [parseFloat(req.params.latitude), parseFloat(request.params.longitude)]
      //       }
      //      }
      //     }
      //    }, function (err, location) {
      //           if (err) {
      //             res.send(err);
      //           } else {
      //             res.send(location);
      //           }
      //         });
      // });
      // //Get Single Driver and emit track by user to driver
      // this.router.get("/driverLocation/:id", function (req, res, next) {
      //   var io = req.app.io;
      //   DriverModel.findOne({ driverId: req.params.id }, function (err, location) {
      //     if (err) {
      //       res.send(err);
      //     }
      //     res.send(location);
      //     io.emit("trackDriver", location);
      //   });
      // });
      // //Update Location by driver to user
      // this.router.put("/driverLocation/:id", function (req, res, next) {
      //   var io = req.app.io;
      //   var location = req.body;
      //   var latitude = parseFloat(location.latitude);
      //   var longitude = parseFloat(location.longitude);
      //   if (!location) {
      //     res.status(400);
      //     res.json({
      //       "error": "Bad Data"
      //     });
      //   } else {
      //     DriverModel.update({ _id: req.params.id }, {
      //       $set: {
      //         socketId: location.socketId,
      //         coordinate: {
      //           "type": "Point",
      //           coordinates: [
      //             longitude,
      //             latitude
      //           ]
      //         }
      //       }
      //     }, function (err, updateDetails) {
      //       if (err) {
      //         console.log(updateDetails);
      //         res.send(err);
      //       }
      //       if (updateDetails) {
      //         //Get updated location
      //         db.driversLocation.findOne({ _id: mongojs.ObjectId(req.params.id) }, function (error, updatedLocation) {
      //           if (error) {
      //             res.send(error);
      //           }
      //           res.send(updatedLocation);
      //           io.emit("action", {
      //             type: "UPDATE_DRIVER_LOCATION",
      //             payload: updatedLocation
      //           });
      //         });
      //       }
      //     });
      //   }
      // });

      cov_1h57fsrwtx.s[22]++;
      return this.router;
    }
  }]);
  return DriversRoutes;
}();

var _default = DriversRoutes;
exports["default"] = _default;
//# sourceMappingURL=driver_routes.js.map