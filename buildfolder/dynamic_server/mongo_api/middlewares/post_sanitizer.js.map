{"version":3,"sources":["../../../../server/dynamic_server/mongo_api/middlewares/post_sanitizer.js"],"names":["locationRegex","validIdRegex","SubmitEventValidator","request","response","next","body","location","images","subject","comment","reportType","length","ErrorHandler","sendError","imageToSubmit","test","status","params","id","console","log"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAIA;;;;;;;;AAEA,IAAMA,aAAa,2BAAG,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","sourcesContent":["/* eslint-disable no-use-before-define */\n/* eslint-disable camelcase */\n/* eslint-disable no-plusplus */\n/* eslint-disable no-mixed-operators */\nimport { ErrorHandler } from '../helpers/error_handler';\n\nconst locationRegex = /^([-+]?\\d{1,2}([.]\\d+)?),\\s*([-+]?\\d{1,3}([.]\\d+)?)$/;\nconst validIdRegex = /^[1-9]{1,}/;\nexport default class SubmitEventValidator {\n  static validateSubmit(request, response, next) {\n    const { location, images, subject, comment, reportType } = request.body;\n\n    \n\n    if (!(reportType && reportType.length)) {\n      return ErrorHandler.sendError(response, 'Category must be a string');\n    }\n\n\n    // if (!(location && location.length)) {\n    //   return ErrorHandler.sendError(response, 'Location must be a string');\n    // }\n    // if (typeof location !== 'string' || !locationRegex.test(location)) {\n    //   return ErrorHandler.sendError(response, 'location does not match a Lat Long coordinates');\n    // }\n     var imageToSubmit =\"no image\"\n    if (!images) {\n      imageToSubmit =\"no image preview\";\n      //return ErrorHandler.sendError(response, 'Please enter an image url');\n    }\n\n    // if (!Array.isArray(images)) {\n    //   return ErrorHandler.sendError(response, 'Images must be an array');\n    // }\n\n    // const notAString = images.filter(image => typeof image !== 'string');\n    // if (notAString.length >= 1) {\n    //   return ErrorHandler.sendError(response, 'image must be a string');\n    // }\n\n    if (!subject) {\n      return ErrorHandler.sendError(response, 'Please enter a subject');\n    }\n    // if (!Array.isArray(videos)) {\n    //   return ErrorHandler.sendError(response, 'videos must be an array');\n    // }\n\n    // const notAVideoString = videos.filter(video => typeof video !== 'string');\n    // if (notAVideoString.length >= 1) {\n    //   return ErrorHandler.sendError(response, 'video must be a string');\n    // }\n\n    if (!comment) {\n      return ErrorHandler.sendError(response, 'Please enter a comment');\n    }\n\n    if (typeof comment !== 'string') {\n      return ErrorHandler.sendError(response, 'comment must be a string of characters');\n    }\n    return next();\n  }\n\n  static validateLocation(request, response, next) {\n    const { location } = request.body;\n    if (!(location && location.length)) {\n      return ErrorHandler.sendError(response, 'Location must be a string');\n    }\n    if (typeof location !== 'string' || !locationRegex.test(location)) {\n      return ErrorHandler.sendError(response, 'location does not match a Lat Long coordinates');\n    }\n    return next();\n  }\n\n  static validateStatus(request, response, next) {\n    const { status } = request.body;\n    if (!(status && status.length)) {\n      return ErrorHandler.sendError(response, 'Status is required');\n    }\n    if (typeof status !== 'string' || status !== 'under investigation' && status !== 'resolved' && status !== 'rejected'){\n      return ErrorHandler.sendError(\n        response,\n        'Invalid status, status must be a string containing under investigation, resolved or rejected',\n      );\n    }\n    return next();\n  }\n\n  static validateComment(request, response, next) {\n    const { comment } = request.body;\n    if (!comment) {\n      return ErrorHandler.sendError(response, 'Please enter a comment');\n    }\n\n    if (typeof comment !== 'string') {\n      return ErrorHandler.sendError(response, 'comment must be a string of characters');\n    }\n    return next();\n  }\n\n  static validateId(request, response, next) {\n    if (!validIdRegex.test(request.params.id)) {\n      console.log('error validating id');\n      return ErrorHandler.sendError(response, 'The given id is not a number');\n    }\n    return next();\n  }\n}\n"],"file":"post_sanitizer.js"}